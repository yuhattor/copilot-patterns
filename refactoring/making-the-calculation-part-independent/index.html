<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="LLM is not good at calculating for now. Moving the calculation part to a separate function makes it easier to develop and maintain."><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:title" content="Making the calculation part independent"><meta property="og:description" content="LLM is not good at calculating for now. Moving the calculation part to a separate function makes it easier to develop and maintain."><meta property="og:type" content="article"><meta property="og:url" content="/refactoring/making-the-calculation-part-independent/"><meta property="article:section" content="refactoring"><meta property="article:modified_time" content="2023-09-07T18:48:15+09:00"><title>Making the calculation part independent | GitHub Copilot Patterns & Exercises</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png><link rel=alternate hreflang=ja href=/ja/refactoring/making-the-calculation-part-independent/ title=è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ã‚’ç‹¬ç«‹ã•ã›ã‚‹><link rel=stylesheet href=/book.min.a0ee8ce313cd8b61c2db36465d140af7679e24d8615ba7cb41039e93e6ac7ebd.css><script defer src=/sw.min.6f6f90fcb8eb1c49ec389838e6b801d0de19430b8e516902f8d75c3c8bd98739.js></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>GitHub Copilot Patterns & Exercises</span></a></h2><ul class=book-languages><li><input type=checkbox id=languages class=toggle>
<label for=languages class="flex justify-between"><a role=button class="flex align-center"><img src=/svg/translate.svg class=book-icon alt=Languages>
English</a></label><ul><li><a href=/ja/refactoring/making-the-calculation-part-independent/>Japanese</a></li></ul></li></ul><div style=margin-bottom:-30px;margin-top:-10px;display:flex><img src=https://i.creativecommons.org/l/by-sa/4.0/88x31.png height=20 style=display:flex;margin-right:6px>
<iframe src="https://ghbtns.com/github-btn.html?user=yuhattor&repo=copilot-patterns&type=star&count=true" frameborder=0 scrolling=0 width=100 height=30 title=GitHub></iframe></div><ul><li><p>About</p><ul><li><a href=/>Introduction</a></li><li><a href=/CONTRIBUTING/>Contributing to the Project</a></li></ul></li><li><p>General</p><ul><li><a href=/general/code-completion/>Code completion</a></li><li><a href=/general/comment-to-code/>Comment to code</a></li><li><a href=/general/code-to-comment/>Code to comment</a></li><li><a href=/general/quick-qna/>Quick Q&amp;A</a></li><li><a href=/general/regular-expression/>Regular expression</a></li><li><a href=/general/language-translation/>Language translation</a></li><li><a href=/general/type-hinting/>Type hinting</a></li><li><a href=/general/code-to-document/>Code to document</a></li><li><a href=/general/object-generation-from-structured-data/>Object generation from structured data</a></li><li><a href=/general/showing-examples/>Showing examples</a></li></ul></li><li><p>Client Side Tips</p><ul><li><a href=/client-tips/copilot-snippet-handling/>Copilot snippet handling</a></li><li><a href=/client-tips/github-copilot-shortcuts/>GitHub Copilot Shortcuts</a></li><li><a href=/client-tips/go-to-definition/>Go to definition</a></li><li><a href=/client-tips/pin-the-file-you-need/>Pin the files you need</a></li></ul></li><li><p>Design Patterns</p><ul><li><a href=/design-pattern/ai-readable-naming-convention/>AI readable naming convention</a></li><li><a href=/design-pattern/consistent-coding-style/>Consistent coding style</a></li><li><a href=/design-pattern/high-level-architecture-first/>High-level architecture first</a></li><li><a href=/design-pattern/working-on-small-chunk/>Working on small chunks</a></li><li><a href=/design-pattern/context-less-architecture/>Context-less Architecture</a></li><li><a href=/design-pattern/eliminating-a-tiny-oss-dependency/>Eliminating a tiny OSS dependency</a></li></ul></li><li><p>Collaboration</p><ul><li><a href=/collaboration/ai-friendly-documentation/>AI friendly documentation</a></li><li><a href=/collaboration/coaching-on-prompts/>Coaching on prompts</a></li></ul></li><li><p>Test</p><ul><li><a href=/testing/creating-unit-tests/>Creating unit tests</a></li><li><a href=/testing/specify-test-valiation/>Specify how to generate test code</a></li><li><a href=/testing/writing-failure-case-first/>Writing failure case first</a></li><li><a href=/testing/writing-test-cases-in-natural-language-first/>Writing test cases in natural language first</a></li><li><a href=/testing/test-only-what-is-necessary/>Test only what is necessary</a></li></ul></li><li><p>Refactoring</p><ul><li><a href=/refactoring/writing-test-code-before-refactoring/>Writing test code before refactoring</a></li><li><a href=/refactoring/making-the-calculation-part-independent/ class=active>Making the calculation part independent</a></li><li><a href=/refactoring/asking-with-open-ended-questions/>Asking with open-ended questions</a></li></ul></li><li><p>Archived Version</p><ul><li><a href=https://ai-native-development.gitbook.io/archived/>English ðŸ‡¬ðŸ‡§</a></li><li><a href=https://ai-native-development.gitbook.io/archived/german>German ðŸ‡©ðŸ‡ª</a></li><li><a href=https://ai-native-development.gitbook.io/archived/spanish>Spanish ðŸ‡ªðŸ‡¸</a></li><li><a href=https://ai-native-development.gitbook.io/archived/french>French ðŸ‡«ðŸ‡·</a></li><li><a href=https://ai-native-development.gitbook.io/archived/italy>Italy ðŸ‡®ðŸ‡¹</a></li><li><a href=https://ai-native-development.gitbook.io/archived/japanese>Japanese ðŸ‡¯ðŸ‡µ</a></li><li><a href=https://ai-native-development.gitbook.io/archived/portuguese>Portuguese ðŸ‡µðŸ‡¹</a></li><li><a href=https://ai-native-development.gitbook.io/archived/chinese>Chinese ðŸ‡¨ðŸ‡³</a></li></ul></li><li><p><a href=https://github.com/yuhattor/copilot-patterns>GitHub</a></p></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Making the calculation part independent</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><ul><li><a href=#making-the-calculation-part-independent>Making the Calculation Part Independent</a><ul><li><a href=#description>Description</a></li><li><a href=#exerecise>Exerecise</a></li><li><a href=#checklist-for-further-learning>Checklist for Further Learning</a></li></ul></li></ul></li></ul></nav></aside></header><article class=markdown><h2 id=making-the-calculation-part-independent>Making the Calculation Part Independent
<a class=anchor href=#making-the-calculation-part-independent>#</a></h2><p><a href=https://github.com/orgs/AI-Native-Development/projects/1/><img src=https://img.shields.io/badge/Lv1-Early_Stage_Pattern-blue></a></p><h3 id=description>Description
<a class=anchor href=#description>#</a></h3><p>In the rapidly evolving world of software development, relying on tools like GitHub Copilot can enhance the development process. However, current versions of large language models may have limitations when handling complex calculations. To address this, developers can refactor their code by moving the computation part to another function. This improves code maintainability, readability, and makes it easier to test and develop with AI tools. Imagine a developer building a financial software system who needs to separate interest calculations from the user interface logic. Every time GitHub Copilot rewrites a particular piece of code, verifying that the logic is correct is a very cumbersome task. By separating this complex computation, you create a codebase that can work with a flexible and more durable AI.</p><h4 id=example>Example
<a class=anchor href=#example>#</a></h4><p><strong>Calculating and Handling Order Totals</strong></p><p>Before, when the calculation logic was mixed with other functionalities:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>handle_order</span>(order_items):
</span></span><span style=display:flex><span>    tax_rate <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.05</span>
</span></span><span style=display:flex><span>    total <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> item <span style=color:#f92672>in</span> order_items:
</span></span><span style=display:flex><span>        total <span style=color:#f92672>+=</span> item[<span style=color:#e6db74>&#39;price&#39;</span>]
</span></span><span style=display:flex><span>    total <span style=color:#f92672>+=</span> total <span style=color:#f92672>*</span> tax_rate
</span></span><span style=display:flex><span>    process_payment(total)
</span></span><span style=display:flex><span>    ship_order(order_items)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> total
</span></span></code></pre></div><p>After, when the calculation logic is completely separated from other functionalities:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>calculate_total</span>(order_items, tax_rate<span style=color:#f92672>=</span><span style=color:#ae81ff>0.05</span>):
</span></span><span style=display:flex><span>    subtotal <span style=color:#f92672>=</span> sum(item[<span style=color:#e6db74>&#39;price&#39;</span>] <span style=color:#66d9ef>for</span> item <span style=color:#f92672>in</span> order_items)
</span></span><span style=display:flex><span>    total <span style=color:#f92672>=</span> subtotal <span style=color:#f92672>+</span> (subtotal <span style=color:#f92672>*</span> tax_rate)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> total
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>handle_order</span>(order_items):
</span></span><span style=display:flex><span>    total <span style=color:#f92672>=</span> calculate_total(order_items)
</span></span><span style=display:flex><span>    process_payment(total)
</span></span><span style=display:flex><span>    ship_order(order_items)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> total
</span></span></code></pre></div><p>Here, the <code>calculate_total</code> function takes care of all the calculations related to the order total, while the <code>handle_order</code> function handles other related functionalities, such as processing payment and shipping the order.</p><h3 id=exerecise>Exerecise
<a class=anchor href=#exerecise>#</a></h3><ul><li><strong>Exercise 1</strong>: Identify a portion of code in your project where the calculation logic is mixed with other functionalities and refactor it using the pattern described above.</li><li><strong>Exercise 2</strong>: Write tests for both the calculation part and the non-calculation part to ensure that they function as intended independently.</li></ul><h3 id=checklist-for-further-learning>Checklist for Further Learning
<a class=anchor href=#checklist-for-further-learning>#</a></h3><ul><li>How can I identify other areas in my codebase where the calculation logic can be isolated?</li><li>What strategies can I employ to ensure that the separation of calculation logic doesnâ€™t introduce new errors or complexities?</li><li>How does this separation align with the broader architecture and design principles of my application?</li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/yuhattor/copilot-patterns/commit/a3934fa4d3350a32fa7417a8772eae52f5363fcc title='Last modified by Yuki Hattori | September 7, 2023' target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>September 7, 2023</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><ul><li><a href=#making-the-calculation-part-independent>Making the Calculation Part Independent</a><ul><li><a href=#description>Description</a></li><li><a href=#exerecise>Exerecise</a></li><li><a href=#checklist-for-further-learning>Checklist for Further Learning</a></li></ul></li></ul></li></ul></nav></div></aside></main></body></html>